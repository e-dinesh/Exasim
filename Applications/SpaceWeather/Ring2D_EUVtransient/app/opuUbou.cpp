template <typename T> void opuUbou1(T *f, T *xdg, T *udg, T *odg, T *wdg, T *uhg, T *nlg, T *tau, T *uinf, T *param, T time, int ng, int nc, int ncu, int nd, int ncx, int nco, int ncw)
{
	for (int i = 0; i <ng; i++) {
		T param1 = param[0];
		T param2 = param[1];
		T param3 = param[2];
		T param4 = param[3];
		T param5 = param[4];
		T param6 = param[5];
		T param7 = param[6];
		T param8 = param[7];
		T param9 = param[8];
		T param10 = param[9];
		T param11 = param[10];
		T param12 = param[11];
		T param13 = param[12];
		T param14 = param[13];
		T param15 = param[14];
		T param16 = param[15];
		T uinf1 = uinf[0];
		T uinf2 = uinf[1];
		T uinf3 = uinf[2];
		T uinf4 = uinf[3];
		T uinf5 = uinf[4];
		T uinf6 = uinf[5];
		T uinf7 = uinf[6];
		T uinf8 = uinf[7];
		T uinf9 = uinf[8];
		T uinf10 = uinf[9];
		T uinf11 = uinf[10];
		T uinf12 = uinf[11];
		T uinf13 = uinf[12];
		T uinf14 = uinf[13];
		T uinf15 = uinf[14];
		T uinf16 = uinf[15];
		T uinf17 = uinf[16];
		T uinf18 = uinf[17];
		T uinf19 = uinf[18];
		T uinf20 = uinf[19];
		T uinf21 = uinf[20];
		T uinf22 = uinf[21];
		T uinf23 = uinf[22];
		T uinf24 = uinf[23];
		T uinf25 = uinf[24];
		T uinf26 = uinf[25];
		T uinf27 = uinf[26];
		T uinf28 = uinf[27];
		T uinf29 = uinf[28];
		T uinf30 = uinf[29];
		T uinf31 = uinf[30];
		T uinf32 = uinf[31];
		T uinf33 = uinf[32];
		T uinf34 = uinf[33];
		T uinf35 = uinf[34];
		T uinf36 = uinf[35];
		T uinf37 = uinf[36];
		T uinf38 = uinf[37];
		T uinf39 = uinf[38];
		T uinf40 = uinf[39];
		T uinf41 = uinf[40];
		T uinf42 = uinf[41];
		T uinf43 = uinf[42];
		T uinf44 = uinf[43];
		T uinf45 = uinf[44];
		T uinf46 = uinf[45];
		T uinf47 = uinf[46];
		T uinf48 = uinf[47];
		T uinf49 = uinf[48];
		T uinf50 = uinf[49];
		T uinf51 = uinf[50];
		T uinf52 = uinf[51];
		T uinf53 = uinf[52];
		T uinf54 = uinf[53];
		T uinf55 = uinf[54];
		T uinf56 = uinf[55];
		T uinf57 = uinf[56];
		T uinf58 = uinf[57];
		T uinf59 = uinf[58];
		T uinf60 = uinf[59];
		T uinf61 = uinf[60];
		T uinf62 = uinf[61];
		T uinf63 = uinf[62];
		T uinf64 = uinf[63];
		T uinf65 = uinf[64];
		T uinf66 = uinf[65];
		T uinf67 = uinf[66];
		T uinf68 = uinf[67];
		T uinf69 = uinf[68];
		T uinf70 = uinf[69];
		T uinf71 = uinf[70];
		T uinf72 = uinf[71];
		T uinf73 = uinf[72];
		T uinf74 = uinf[73];
		T uinf75 = uinf[74];
		T uinf76 = uinf[75];
		T uinf77 = uinf[76];
		T uinf78 = uinf[77];
		T uinf79 = uinf[78];
		T uinf80 = uinf[79];
		T uinf81 = uinf[80];
		T uinf82 = uinf[81];
		T uinf83 = uinf[82];
		T uinf84 = uinf[83];
		T uinf85 = uinf[84];
		T uinf86 = uinf[85];
		T uinf87 = uinf[86];
		T uinf88 = uinf[87];
		T uinf89 = uinf[88];
		T uinf90 = uinf[89];
		T uinf91 = uinf[90];
		T uinf92 = uinf[91];
		T uinf93 = uinf[92];
		T uinf94 = uinf[93];
		T uinf95 = uinf[94];
		T uinf96 = uinf[95];
		T uinf97 = uinf[96];
		T uinf98 = uinf[97];
		T uinf99 = uinf[98];
		T uinf100 = uinf[99];
		T uinf101 = uinf[100];
		T uinf102 = uinf[101];
		T uinf103 = uinf[102];
		T uinf104 = uinf[103];
		T uinf105 = uinf[104];
		T uinf106 = uinf[105];
		T uinf107 = uinf[106];
		T uinf108 = uinf[107];
		T uinf109 = uinf[108];
		T uinf110 = uinf[109];
		T uinf111 = uinf[110];
		T uinf112 = uinf[111];
		T uinf113 = uinf[112];
		T uinf114 = uinf[113];
		T uinf115 = uinf[114];
		T uinf116 = uinf[115];
		T uinf117 = uinf[116];
		T uinf118 = uinf[117];
		T uinf119 = uinf[118];
		T uinf120 = uinf[119];
		T uinf121 = uinf[120];
		T uinf122 = uinf[121];
		T uinf123 = uinf[122];
		T uinf124 = uinf[123];
		T uinf125 = uinf[124];
		T uinf126 = uinf[125];
		T uinf127 = uinf[126];
		T uinf128 = uinf[127];
		T uinf129 = uinf[128];
		T uinf130 = uinf[129];
		T uinf131 = uinf[130];
		T uinf132 = uinf[131];
		T uinf133 = uinf[132];
		T uinf134 = uinf[133];
		T uinf135 = uinf[134];
		T uinf136 = uinf[135];
		T uinf137 = uinf[136];
		T uinf138 = uinf[137];
		T uinf139 = uinf[138];
		T uinf140 = uinf[139];
		T uinf141 = uinf[140];
		T uinf142 = uinf[141];
		T uinf143 = uinf[142];
		T uinf144 = uinf[143];
		T uinf145 = uinf[144];
		T uinf146 = uinf[145];
		T uinf147 = uinf[146];
		T uinf148 = uinf[147];
		T tau1 = tau[0];
		T xdg1 = xdg[0*ng+i];
		T xdg2 = xdg[1*ng+i];
		T udg1 = udg[0*ng+i];
		T udg2 = udg[1*ng+i];
		T udg3 = udg[2*ng+i];
		T udg4 = udg[3*ng+i];
		T udg5 = udg[4*ng+i];
		T udg6 = udg[5*ng+i];
		T udg7 = udg[6*ng+i];
		T udg8 = udg[7*ng+i];
		T udg9 = udg[8*ng+i];
		T udg10 = udg[9*ng+i];
		T udg11 = udg[10*ng+i];
		T udg12 = udg[11*ng+i];
		T uhg1 = uhg[0*ng+i];
		T uhg2 = uhg[1*ng+i];
		T uhg3 = uhg[2*ng+i];
		T uhg4 = uhg[3*ng+i];
		T odg1 = odg[0*ng+i];
		T nlg1 = nlg[0*ng+i];
		T nlg2 = nlg[1*ng+i];
		f[0*ng+i] = udg1;
		f[1*ng+i] = 0.0;
		f[2*ng+i] = 0.0;
		f[3*ng+i] = param8;
	}
}

template <typename T> void opuUbou2(T *f, T *xdg, T *udg, T *odg, T *wdg, T *uhg, T *nlg, T *tau, T *uinf, T *param, T time, int ng, int nc, int ncu, int nd, int ncx, int nco, int ncw)
{
	for (int i = 0; i <ng; i++) {
		T param1 = param[0];
		T param2 = param[1];
		T param3 = param[2];
		T param4 = param[3];
		T param5 = param[4];
		T param6 = param[5];
		T param7 = param[6];
		T param8 = param[7];
		T param9 = param[8];
		T param10 = param[9];
		T param11 = param[10];
		T param12 = param[11];
		T param13 = param[12];
		T param14 = param[13];
		T param15 = param[14];
		T param16 = param[15];
		T uinf1 = uinf[0];
		T uinf2 = uinf[1];
		T uinf3 = uinf[2];
		T uinf4 = uinf[3];
		T uinf5 = uinf[4];
		T uinf6 = uinf[5];
		T uinf7 = uinf[6];
		T uinf8 = uinf[7];
		T uinf9 = uinf[8];
		T uinf10 = uinf[9];
		T uinf11 = uinf[10];
		T uinf12 = uinf[11];
		T uinf13 = uinf[12];
		T uinf14 = uinf[13];
		T uinf15 = uinf[14];
		T uinf16 = uinf[15];
		T uinf17 = uinf[16];
		T uinf18 = uinf[17];
		T uinf19 = uinf[18];
		T uinf20 = uinf[19];
		T uinf21 = uinf[20];
		T uinf22 = uinf[21];
		T uinf23 = uinf[22];
		T uinf24 = uinf[23];
		T uinf25 = uinf[24];
		T uinf26 = uinf[25];
		T uinf27 = uinf[26];
		T uinf28 = uinf[27];
		T uinf29 = uinf[28];
		T uinf30 = uinf[29];
		T uinf31 = uinf[30];
		T uinf32 = uinf[31];
		T uinf33 = uinf[32];
		T uinf34 = uinf[33];
		T uinf35 = uinf[34];
		T uinf36 = uinf[35];
		T uinf37 = uinf[36];
		T uinf38 = uinf[37];
		T uinf39 = uinf[38];
		T uinf40 = uinf[39];
		T uinf41 = uinf[40];
		T uinf42 = uinf[41];
		T uinf43 = uinf[42];
		T uinf44 = uinf[43];
		T uinf45 = uinf[44];
		T uinf46 = uinf[45];
		T uinf47 = uinf[46];
		T uinf48 = uinf[47];
		T uinf49 = uinf[48];
		T uinf50 = uinf[49];
		T uinf51 = uinf[50];
		T uinf52 = uinf[51];
		T uinf53 = uinf[52];
		T uinf54 = uinf[53];
		T uinf55 = uinf[54];
		T uinf56 = uinf[55];
		T uinf57 = uinf[56];
		T uinf58 = uinf[57];
		T uinf59 = uinf[58];
		T uinf60 = uinf[59];
		T uinf61 = uinf[60];
		T uinf62 = uinf[61];
		T uinf63 = uinf[62];
		T uinf64 = uinf[63];
		T uinf65 = uinf[64];
		T uinf66 = uinf[65];
		T uinf67 = uinf[66];
		T uinf68 = uinf[67];
		T uinf69 = uinf[68];
		T uinf70 = uinf[69];
		T uinf71 = uinf[70];
		T uinf72 = uinf[71];
		T uinf73 = uinf[72];
		T uinf74 = uinf[73];
		T uinf75 = uinf[74];
		T uinf76 = uinf[75];
		T uinf77 = uinf[76];
		T uinf78 = uinf[77];
		T uinf79 = uinf[78];
		T uinf80 = uinf[79];
		T uinf81 = uinf[80];
		T uinf82 = uinf[81];
		T uinf83 = uinf[82];
		T uinf84 = uinf[83];
		T uinf85 = uinf[84];
		T uinf86 = uinf[85];
		T uinf87 = uinf[86];
		T uinf88 = uinf[87];
		T uinf89 = uinf[88];
		T uinf90 = uinf[89];
		T uinf91 = uinf[90];
		T uinf92 = uinf[91];
		T uinf93 = uinf[92];
		T uinf94 = uinf[93];
		T uinf95 = uinf[94];
		T uinf96 = uinf[95];
		T uinf97 = uinf[96];
		T uinf98 = uinf[97];
		T uinf99 = uinf[98];
		T uinf100 = uinf[99];
		T uinf101 = uinf[100];
		T uinf102 = uinf[101];
		T uinf103 = uinf[102];
		T uinf104 = uinf[103];
		T uinf105 = uinf[104];
		T uinf106 = uinf[105];
		T uinf107 = uinf[106];
		T uinf108 = uinf[107];
		T uinf109 = uinf[108];
		T uinf110 = uinf[109];
		T uinf111 = uinf[110];
		T uinf112 = uinf[111];
		T uinf113 = uinf[112];
		T uinf114 = uinf[113];
		T uinf115 = uinf[114];
		T uinf116 = uinf[115];
		T uinf117 = uinf[116];
		T uinf118 = uinf[117];
		T uinf119 = uinf[118];
		T uinf120 = uinf[119];
		T uinf121 = uinf[120];
		T uinf122 = uinf[121];
		T uinf123 = uinf[122];
		T uinf124 = uinf[123];
		T uinf125 = uinf[124];
		T uinf126 = uinf[125];
		T uinf127 = uinf[126];
		T uinf128 = uinf[127];
		T uinf129 = uinf[128];
		T uinf130 = uinf[129];
		T uinf131 = uinf[130];
		T uinf132 = uinf[131];
		T uinf133 = uinf[132];
		T uinf134 = uinf[133];
		T uinf135 = uinf[134];
		T uinf136 = uinf[135];
		T uinf137 = uinf[136];
		T uinf138 = uinf[137];
		T uinf139 = uinf[138];
		T uinf140 = uinf[139];
		T uinf141 = uinf[140];
		T uinf142 = uinf[141];
		T uinf143 = uinf[142];
		T uinf144 = uinf[143];
		T uinf145 = uinf[144];
		T uinf146 = uinf[145];
		T uinf147 = uinf[146];
		T uinf148 = uinf[147];
		T tau1 = tau[0];
		T xdg1 = xdg[0*ng+i];
		T xdg2 = xdg[1*ng+i];
		T udg1 = udg[0*ng+i];
		T udg2 = udg[1*ng+i];
		T udg3 = udg[2*ng+i];
		T udg4 = udg[3*ng+i];
		T udg5 = udg[4*ng+i];
		T udg6 = udg[5*ng+i];
		T udg7 = udg[6*ng+i];
		T udg8 = udg[7*ng+i];
		T udg9 = udg[8*ng+i];
		T udg10 = udg[9*ng+i];
		T udg11 = udg[10*ng+i];
		T udg12 = udg[11*ng+i];
		T uhg1 = uhg[0*ng+i];
		T uhg2 = uhg[1*ng+i];
		T uhg3 = uhg[2*ng+i];
		T uhg4 = uhg[3*ng+i];
		T odg1 = odg[0*ng+i];
		T nlg1 = nlg[0*ng+i];
		T nlg2 = nlg[1*ng+i];
		T t2 = nlg1*udg2;
		T t3 = nlg2*udg3;
		T t4 = t2+t3;
		f[0*ng+i] = udg1;
		f[1*ng+i] = udg2-nlg1*t4;
		f[2*ng+i] = udg3-nlg2*t4;
		f[3*ng+i] = udg4;
	}
}

template <typename T> void opuUbou(T *f, T *xdg, T *udg, T *odg, T *wdg, T *uhg, T *nlg, T *tau, T *uinf, T *param, T time, int ib, int ng, int nc, int ncu, int nd, int ncx, int nco, int ncw)
{
	if (ib == 1)
		opuUbou1(f, xdg, udg, odg, wdg, uhg, nlg, tau, uinf, param, time, ng, nc, ncu, nd, ncx, nco, ncw);
	else if (ib == 2)
		opuUbou2(f, xdg, udg, odg, wdg, uhg, nlg, tau, uinf, param, time, ng, nc, ncu, nd, ncx, nco, ncw);
}

template void opuUbou(double *, double *, double *, double *, double *, double *, double *, double *, double *, double *, double, int, int, int, int, int, int, int, int);
template void opuUbou(float *, float *, float *, float *, float *, float *, float *, float *, float *, float *, float, int, int, int, int, int, int, int, int);
